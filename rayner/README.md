# Rayner

## План настроек

1. Необходимо выполнить первичную настройку Wirenboard, при которой добавляются все устройства.
2. Необходимо установить [Tailscale](https://wirenboard.com/wiki/Tailscale), это решение позволит подключаться к контроллеру внутри VPN сети без поднятия своего VPN сервера, до 100 устройств и 3 пользователей, идеально для частного пользования.
3. Необходимо купить облачную виртуальную машину, и создать своего брокера с логином и паролем [MQTT](https://wirenboard.com/wiki/MQTT), это позволит получать доступ к данным контроллера и изменять их из интернета, зная логи и пароль, стоит задуматься и о работе по TLS.
4. Выполнить развертывание на той же виртуальной машине сервис `Rayner`, который будет запущен в SLAVE режиме по отношению к тому, который будет развернут в доме.
5. Выполнить развертывание на ПК в доме сервиса `Rayner`, в режиме MASTER по отношению к тому, что развернут в облаке.
6. Настроить мост между контроллером и облачным брокером.
7. Настроить мост между контроллером и компом в доме.

Все дальнейшие коммуникации по MQTT будут происходить в рамках MQTT шины контроллера.

Нужно будет завести канал, в который будут пинговать свое состояние оба компа облачный и домашний, исходя из этого знания они буду понимать в каком режиме работать.

Если домашний комп перестал присылать кинг, то облачный становится мастером.
Если какой либо комп перестал присылать пинг в течении 30 минут, то контроллер сделает алерт в каком-то виде, допустим СМС.

## Архитектура

### Аутентификация

См. [Token-Based Authentication](./docs/Token-Based-Authentication.md)

### Сбор данных

### План разработки

1. Реализовать подписку на устройства ✅
2. Реализовать АПИ для разметки устройств
3. Реализовать АПИ для изменения значения устройства
